function [t,y] = Heun(dydt,tspan,y0,h,es,maxit)
%UNTITLED Summary of this function goes here
%   Detailed explanation goes here
err = 100;% Initialize error
t = tspan(1) : h: tspan(s);
s = length(t);% Find size of domain
y = zeros(1,s);
y(1) = y0;
for i = tspan(1) : tspan(s) : h% Initialize for loop to run for the domain
    iter = 0;% Initialize iteration counter
    guess2 = y0;% Create variable to mark the guess
    while err > es || iter < maxit% embeded while loop runs until approx error condition is met
        iter = iter + 1;
        slopeleft = dydt(t(iter),y(iter));%evaluate dydt at y0 and i to find predictor slope
        y = y0 + (h * slopeleft);%Use Euler's method to find y at i + 1
        sloperight = dydt(t(iter+1),guess1);
        guess2 = (y0 + ((h/2) * (slopeleft + sloperight))); %find the average value between y(i) and y(i+1) (y0 +
        %(h/2)*(slopeleft + sloperight)
        %guess2 =  guess2 + (h * slopecorrect);%use corrector value to get a better estimate at y(i+1)
        err = ((abs(guess2 - guess1))/guess1)*100;
    end
    t = i + 1;
    y = guess2;
    
end
end

