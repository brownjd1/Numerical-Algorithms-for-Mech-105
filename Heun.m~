function [t,y] = Heun(dydt,tspan,y0,h,es,maxit)
%UNTITLED Summary of this function goes here
%   Detailed explanation goes here
h = [h diff(t)];%Define h as all of the differences in t
s = length(tspan);% Find size of domain
t = tspan(1) : h : tspan(s);
y(1:length(t)) = 0;
y(1) = y0;
for i = 1 : length(t)-1 % Initialize for loop to run for the domain
    iter = 0;% Initialize iteration counter
    y(i+1) = y(i) + (h * dydt(t(i),y(i)));%Use Euler's method to find y at i + 1
    ea = 100;% Initialize error
    while ea > es && iter < maxit% embeded while loop runs until approx error condition is met
        yold = y(i+1);
        %slopeleft = ;%evaluate dydt at y0 and i to find predictor slope
        %sloperight = dydt(t(i+1),y(i+1));
        y(i+1) = (y(i) + ((h/2) * (dydt(t(i),y(i)) + dydt(t(i+1),y(i+1))))); %find the average value between y(i) and y(i+1) (y0 +
        %(h/2)*(slopeleft + sloperight)
        %guess2 =  guess2 + (h * slopecorrect);%use corrector value to get a better estimate at y(i+1)
        ea = ((abs(y(i+1) - yold))/y(i+1))*100;
        iter = iter + 1;
    end
end
end

